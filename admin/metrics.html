<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Métricas – Museo 360</title>
<style>
  body{margin:0;min-height:100vh;display:flex;align-items:flex-start;justify-content:center;background:#0b0b0b;color:#eee;font-family:system-ui,Segoe UI,Roboto;padding:30px}
  .wrap{width:min(1100px,96vw)}
  h1{margin:0 0 16px;color:#d4af37}
  .row{display:flex;gap:10px;margin:14px 0;flex-wrap:wrap}
  .btn{padding:10px 14px;border-radius:10px;border:0;cursor:pointer;background:linear-gradient(135deg,#d4af37,#8c6c1a);color:#fff;text-decoration:none;display:inline-block}
  .card{background:#141414;border:1px solid rgba(255,255,255,.1);border-radius:12px;padding:16px 14px;margin-top:10px}
  table{width:100%;border-collapse:collapse;margin-top:8px;font-size:.95rem}
  th,td{border-bottom:1px solid rgba(255,255,255,.08);padding:6px 4px;text-align:left}
  .muted{color:#bbb;font-size:.95rem;line-height:1.5}
  code{background:#222;padding:2px 6px;border-radius:6px}
</style>
</head>
<body>
<div class="wrap">
  <h1>Métricas del museo</h1>

  <div class="row">
    <a class="btn" id="repo" target="_blank" rel="noopener">Abrir repositorio</a>
    <a class="btn" href="../index.html">Volver al museo</a>
    <button class="btn" id="reset">Reiniciar visitas</button>
  </div>

  <div class="card">
    <h3>Visitas</h3>
    <p class="muted">Conteo local en este navegador.</p>
    <div id="visitas"></div>
  </div>

  <div class="card">
    <h3>¿Cómo modificar el sitio?</h3>
    <p class="muted">
      Para agregar o cambiar contenido del museo, debes hacerlo <b>directamente en el código del repositorio</b>.
      Abre el repo, edita los archivos y confirma los cambios. Archivos clave:
    </p>
    <ul class="muted">
      <li><code>/index.html</code> — página principal del museo (H5P + scripts).</li>
      <li><code>/main.js</code> — lógica de modales, presentación y navegación.</li>
      <li><code>/ficha/presentacion.html</code> — pantalla de bienvenida / submenú.</li>
      <li><code>/ficha/objeto_*.html</code> — fichas individuales con modelo 3D, texto y audio.</li>
      <li><code>/imagenes/</code> y <code>/audio/</code> — recursos multimedia.</li>
    </ul>
    <p class="muted">
      Recomendado: crear una rama, editar y hacer Pull Request. Si es un repo público, solo tendrás permisos según la
      configuración del repositorio.
    </p>
  </div>
</div>

<script>
const METRICS_KEY = 'museo360_metrics_v1';
const RepoURL = 'https://github.com/Wigfloo/mauseo_360'; // <-- tu repo público

document.getElementById('repo').href = RepoURL;

function load(){
  try { return JSON.parse(localStorage.getItem(METRICS_KEY)) || {}; }
  catch { return {}; }
}
function save(m){ localStorage.setItem(METRICS_KEY, JSON.stringify(m)); }

function render(){
  const m = load();
  const site = m.site || {};
  document.getElementById('visitas').innerHTML = `
    <table>
      <tr><th>Total visitas</th><td>${site.visits || 0}</td></tr>
      <tr><th>Última visita</th><td>${site.lastVisit ? new Date(site.lastVisit).toLocaleString() : '-'}</td></tr>
    </table>
  `;
}
render();

document.getElementById('reset').onclick = () => {
  if (confirm('¿Borrar visitas locales?')) {
    const m = load();
    m.site = { visits: 0, lastVisit: null };
    save(m);
    render();
  }
};
</script>
</body>
</html>
